#!/usr/bin/env node
"use strict";var Rt=Object.create;var Ne=Object.defineProperty;var Pt=Object.getOwnPropertyDescriptor;var kt=Object.getOwnPropertyNames;var It=Object.getPrototypeOf,Mt=Object.prototype.hasOwnProperty;var y=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Ht=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of kt(e))!Mt.call(n,r)&&r!==t&&Ne(n,r,{get:()=>e[r],enumerable:!(i=Pt(e,r))||i.enumerable});return n};var _=(n,e,t)=>(t=n!=null?Rt(It(n)):{},Ht(e||!n||!n.__esModule?Ne(t,"default",{value:n,enumerable:!0}):t,n));var M=y(re=>{var $=class extends Error{constructor(e,t,i){super(i),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=t,this.exitCode=e,this.nestedError=void 0}},ne=class extends ${constructor(e){super(1,"commander.invalidArgument",e),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}};re.CommanderError=$;re.InvalidArgumentError=ne});var U=y(oe=>{var{InvalidArgumentError:Dt}=M(),se=class{constructor(e,t){switch(this.description=t||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,e[0]){case"<":this.required=!0,this._name=e.slice(1,-1);break;case"[":this.required=!1,this._name=e.slice(1,-1);break;default:this.required=!0,this._name=e;break}this._name.length>3&&this._name.slice(-3)==="..."&&(this.variadic=!0,this._name=this._name.slice(0,-3))}name(){return this._name}_concatValue(e,t){return t===this.defaultValue||!Array.isArray(t)?[e]:t.concat(e)}default(e,t){return this.defaultValue=e,this.defaultValueDescription=t,this}argParser(e){return this.parseArg=e,this}choices(e){return this.argChoices=e.slice(),this.parseArg=(t,i)=>{if(!this.argChoices.includes(t))throw new Dt(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._concatValue(t,i):t},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}};function Lt(n){let e=n.name()+(n.variadic===!0?"...":"");return n.required?"<"+e+">":"["+e+"]"}oe.Argument=se;oe.humanReadableArgName=Lt});var ce=y(Re=>{var{humanReadableArgName:Vt}=U(),ae=class{constructor(){this.helpWidth=void 0,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}visibleCommands(e){let t=e.commands.filter(r=>!r._hidden),i=e._getHelpCommand();return i&&!i._hidden&&t.push(i),this.sortSubcommands&&t.sort((r,s)=>r.name().localeCompare(s.name())),t}compareOptions(e,t){let i=r=>r.short?r.short.replace(/^-/,""):r.long.replace(/^--/,"");return i(e).localeCompare(i(t))}visibleOptions(e){let t=e.options.filter(r=>!r.hidden),i=e._getHelpOption();if(i&&!i.hidden){let r=i.short&&e._findOption(i.short),s=i.long&&e._findOption(i.long);!r&&!s?t.push(i):i.long&&!s?t.push(e.createOption(i.long,i.description)):i.short&&!r&&t.push(e.createOption(i.short,i.description))}return this.sortOptions&&t.sort(this.compareOptions),t}visibleGlobalOptions(e){if(!this.showGlobalOptions)return[];let t=[];for(let i=e.parent;i;i=i.parent){let r=i.options.filter(s=>!s.hidden);t.push(...r)}return this.sortOptions&&t.sort(this.compareOptions),t}visibleArguments(e){return e._argsDescription&&e.registeredArguments.forEach(t=>{t.description=t.description||e._argsDescription[t.name()]||""}),e.registeredArguments.find(t=>t.description)?e.registeredArguments:[]}subcommandTerm(e){let t=e.registeredArguments.map(i=>Vt(i)).join(" ");return e._name+(e._aliases[0]?"|"+e._aliases[0]:"")+(e.options.length?" [options]":"")+(t?" "+t:"")}optionTerm(e){return e.flags}argumentTerm(e){return e.name()}longestSubcommandTermLength(e,t){return t.visibleCommands(e).reduce((i,r)=>Math.max(i,t.subcommandTerm(r).length),0)}longestOptionTermLength(e,t){return t.visibleOptions(e).reduce((i,r)=>Math.max(i,t.optionTerm(r).length),0)}longestGlobalOptionTermLength(e,t){return t.visibleGlobalOptions(e).reduce((i,r)=>Math.max(i,t.optionTerm(r).length),0)}longestArgumentTermLength(e,t){return t.visibleArguments(e).reduce((i,r)=>Math.max(i,t.argumentTerm(r).length),0)}commandUsage(e){let t=e._name;e._aliases[0]&&(t=t+"|"+e._aliases[0]);let i="";for(let r=e.parent;r;r=r.parent)i=r.name()+" "+i;return i+t+" "+e.usage()}commandDescription(e){return e.description()}subcommandDescription(e){return e.summary()||e.description()}optionDescription(e){let t=[];return e.argChoices&&t.push(`choices: ${e.argChoices.map(i=>JSON.stringify(i)).join(", ")}`),e.defaultValue!==void 0&&(e.required||e.optional||e.isBoolean()&&typeof e.defaultValue=="boolean")&&t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`),e.presetArg!==void 0&&e.optional&&t.push(`preset: ${JSON.stringify(e.presetArg)}`),e.envVar!==void 0&&t.push(`env: ${e.envVar}`),t.length>0?`${e.description} (${t.join(", ")})`:e.description}argumentDescription(e){let t=[];if(e.argChoices&&t.push(`choices: ${e.argChoices.map(i=>JSON.stringify(i)).join(", ")}`),e.defaultValue!==void 0&&t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`),t.length>0){let i=`(${t.join(", ")})`;return e.description?`${e.description} ${i}`:i}return e.description}formatHelp(e,t){let i=t.padWidth(e,t),r=t.helpWidth||80,s=2,o=2;function c(d,w){if(w){let ie=`${d.padEnd(i+o)}${w}`;return t.wrap(ie,r-s,i+o)}return d}function a(d){return d.join(`
`).replace(/^/gm," ".repeat(s))}let l=[`Usage: ${t.commandUsage(e)}`,""],u=t.commandDescription(e);u.length>0&&(l=l.concat([t.wrap(u,r,0),""]));let h=t.visibleArguments(e).map(d=>c(t.argumentTerm(d),t.argumentDescription(d)));h.length>0&&(l=l.concat(["Arguments:",a(h),""]));let C=t.visibleOptions(e).map(d=>c(t.optionTerm(d),t.optionDescription(d)));if(C.length>0&&(l=l.concat(["Options:",a(C),""])),this.showGlobalOptions){let d=t.visibleGlobalOptions(e).map(w=>c(t.optionTerm(w),t.optionDescription(w)));d.length>0&&(l=l.concat(["Global Options:",a(d),""]))}let R=t.visibleCommands(e).map(d=>c(t.subcommandTerm(d),t.subcommandDescription(d)));return R.length>0&&(l=l.concat(["Commands:",a(R),""])),l.join(`
`)}padWidth(e,t){return Math.max(t.longestOptionTermLength(e,t),t.longestGlobalOptionTermLength(e,t),t.longestSubcommandTermLength(e,t),t.longestArgumentTermLength(e,t))}wrap(e,t,i,r=40){let s=" \\f\\t\\v\xA0\u1680\u2000-\u200A\u202F\u205F\u3000\uFEFF",o=new RegExp(`[\\n][${s}]+`);if(e.match(o))return e;let c=t-i;if(c<r)return e;let a=e.slice(0,i),l=e.slice(i).replace(`\r
`,`
`),u=" ".repeat(i),C="\\s\u200B",R=new RegExp(`
|.{1,${c-1}}([${C}]|$)|[^${C}]+?([${C}]|$)`,"g"),d=l.match(R)||[];return a+d.map((w,ie)=>w===`
`?"":(ie>0?u:"")+w.trimEnd()).join(`
`)}};Re.Help=ae});var fe=y(he=>{var{InvalidArgumentError:Ft}=M(),le=class{constructor(e,t){this.flags=e,this.description=t||"",this.required=e.includes("<"),this.optional=e.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(e),this.mandatory=!1;let i=Ut(e);this.short=i.shortFlag,this.long=i.longFlag,this.negate=!1,this.long&&(this.negate=this.long.startsWith("--no-")),this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0}default(e,t){return this.defaultValue=e,this.defaultValueDescription=t,this}preset(e){return this.presetArg=e,this}conflicts(e){return this.conflictsWith=this.conflictsWith.concat(e),this}implies(e){let t=e;return typeof e=="string"&&(t={[e]:!0}),this.implied=Object.assign(this.implied||{},t),this}env(e){return this.envVar=e,this}argParser(e){return this.parseArg=e,this}makeOptionMandatory(e=!0){return this.mandatory=!!e,this}hideHelp(e=!0){return this.hidden=!!e,this}_concatValue(e,t){return t===this.defaultValue||!Array.isArray(t)?[e]:t.concat(e)}choices(e){return this.argChoices=e.slice(),this.parseArg=(t,i)=>{if(!this.argChoices.includes(t))throw new Ft(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._concatValue(t,i):t},this}name(){return this.long?this.long.replace(/^--/,""):this.short.replace(/^-/,"")}attributeName(){return $t(this.name().replace(/^no-/,""))}is(e){return this.short===e||this.long===e}isBoolean(){return!this.required&&!this.optional&&!this.negate}},ue=class{constructor(e){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,e.forEach(t=>{t.negate?this.negativeOptions.set(t.attributeName(),t):this.positiveOptions.set(t.attributeName(),t)}),this.negativeOptions.forEach((t,i)=>{this.positiveOptions.has(i)&&this.dualOptions.add(i)})}valueFromOption(e,t){let i=t.attributeName();if(!this.dualOptions.has(i))return!0;let r=this.negativeOptions.get(i).presetArg,s=r!==void 0?r:!1;return t.negate===(s===e)}};function $t(n){return n.split("-").reduce((e,t)=>e+t[0].toUpperCase()+t.slice(1))}function Ut(n){let e,t,i=n.split(/[ |,]+/);return i.length>1&&!/^[[<]/.test(i[1])&&(e=i.shift()),t=i.shift(),!e&&/^-[^-]$/.test(t)&&(e=t,t=void 0),{shortFlag:e,longFlag:t}}he.Option=le;he.DualOptions=ue});var ke=y(Pe=>{function qt(n,e){if(Math.abs(n.length-e.length)>3)return Math.max(n.length,e.length);let t=[];for(let i=0;i<=n.length;i++)t[i]=[i];for(let i=0;i<=e.length;i++)t[0][i]=i;for(let i=1;i<=e.length;i++)for(let r=1;r<=n.length;r++){let s=1;n[r-1]===e[i-1]?s=0:s=1,t[r][i]=Math.min(t[r-1][i]+1,t[r][i-1]+1,t[r-1][i-1]+s),r>1&&i>1&&n[r-1]===e[i-2]&&n[r-2]===e[i-1]&&(t[r][i]=Math.min(t[r][i],t[r-2][i-2]+1))}return t[n.length][e.length]}function Wt(n,e){if(!e||e.length===0)return"";e=Array.from(new Set(e));let t=n.startsWith("--");t&&(n=n.slice(2),e=e.map(o=>o.slice(2)));let i=[],r=3,s=.4;return e.forEach(o=>{if(o.length<=1)return;let c=qt(n,o),a=Math.max(n.length,o.length);(a-c)/a>s&&(c<r?(r=c,i=[o]):c===r&&i.push(o))}),i.sort((o,c)=>o.localeCompare(c)),t&&(i=i.map(o=>`--${o}`)),i.length>1?`
(Did you mean one of ${i.join(", ")}?)`:i.length===1?`
(Did you mean ${i[0]}?)`:""}Pe.suggestSimilar=Wt});var Le=y(De=>{var Gt=require("node:events").EventEmitter,me=require("node:child_process"),b=require("node:path"),pe=require("node:fs"),p=require("node:process"),{Argument:Bt,humanReadableArgName:jt}=U(),{CommanderError:de}=M(),{Help:Yt}=ce(),{Option:Ie,DualOptions:Xt}=fe(),{suggestSimilar:Me}=ke(),ge=class n extends Gt{constructor(e){super(),this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!0,this.registeredArguments=[],this._args=this.registeredArguments,this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=e||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._outputConfiguration={writeOut:t=>p.stdout.write(t),writeErr:t=>p.stderr.write(t),getOutHelpWidth:()=>p.stdout.isTTY?p.stdout.columns:void 0,getErrHelpWidth:()=>p.stderr.isTTY?p.stderr.columns:void 0,outputError:(t,i)=>i(t)},this._hidden=!1,this._helpOption=void 0,this._addImplicitHelpCommand=void 0,this._helpCommand=void 0,this._helpConfiguration={}}copyInheritedSettings(e){return this._outputConfiguration=e._outputConfiguration,this._helpOption=e._helpOption,this._helpCommand=e._helpCommand,this._helpConfiguration=e._helpConfiguration,this._exitCallback=e._exitCallback,this._storeOptionsAsProperties=e._storeOptionsAsProperties,this._combineFlagAndOptionalValue=e._combineFlagAndOptionalValue,this._allowExcessArguments=e._allowExcessArguments,this._enablePositionalOptions=e._enablePositionalOptions,this._showHelpAfterError=e._showHelpAfterError,this._showSuggestionAfterError=e._showSuggestionAfterError,this}_getCommandAndAncestors(){let e=[];for(let t=this;t;t=t.parent)e.push(t);return e}command(e,t,i){let r=t,s=i;typeof r=="object"&&r!==null&&(s=r,r=null),s=s||{};let[,o,c]=e.match(/([^ ]+) *(.*)/),a=this.createCommand(o);return r&&(a.description(r),a._executableHandler=!0),s.isDefault&&(this._defaultCommandName=a._name),a._hidden=!!(s.noHelp||s.hidden),a._executableFile=s.executableFile||null,c&&a.arguments(c),this._registerCommand(a),a.parent=this,a.copyInheritedSettings(this),r?this:a}createCommand(e){return new n(e)}createHelp(){return Object.assign(new Yt,this.configureHelp())}configureHelp(e){return e===void 0?this._helpConfiguration:(this._helpConfiguration=e,this)}configureOutput(e){return e===void 0?this._outputConfiguration:(Object.assign(this._outputConfiguration,e),this)}showHelpAfterError(e=!0){return typeof e!="string"&&(e=!!e),this._showHelpAfterError=e,this}showSuggestionAfterError(e=!0){return this._showSuggestionAfterError=!!e,this}addCommand(e,t){if(!e._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);return t=t||{},t.isDefault&&(this._defaultCommandName=e._name),(t.noHelp||t.hidden)&&(e._hidden=!0),this._registerCommand(e),e.parent=this,e._checkForBrokenPassThrough(),this}createArgument(e,t){return new Bt(e,t)}argument(e,t,i,r){let s=this.createArgument(e,t);return typeof i=="function"?s.default(r).argParser(i):s.default(i),this.addArgument(s),this}arguments(e){return e.trim().split(/ +/).forEach(t=>{this.argument(t)}),this}addArgument(e){let t=this.registeredArguments.slice(-1)[0];if(t&&t.variadic)throw new Error(`only the last argument can be variadic '${t.name()}'`);if(e.required&&e.defaultValue!==void 0&&e.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${e.name()}'`);return this.registeredArguments.push(e),this}helpCommand(e,t){if(typeof e=="boolean")return this._addImplicitHelpCommand=e,this;e=e??"help [command]";let[,i,r]=e.match(/([^ ]+) *(.*)/),s=t??"display help for command",o=this.createCommand(i);return o.helpOption(!1),r&&o.arguments(r),s&&o.description(s),this._addImplicitHelpCommand=!0,this._helpCommand=o,this}addHelpCommand(e,t){return typeof e!="object"?(this.helpCommand(e,t),this):(this._addImplicitHelpCommand=!0,this._helpCommand=e,this)}_getHelpCommand(){return this._addImplicitHelpCommand??(this.commands.length&&!this._actionHandler&&!this._findCommand("help"))?(this._helpCommand===void 0&&this.helpCommand(void 0,void 0),this._helpCommand):null}hook(e,t){let i=["preSubcommand","preAction","postAction"];if(!i.includes(e))throw new Error(`Unexpected value for event passed to hook : '${e}'.
Expecting one of '${i.join("', '")}'`);return this._lifeCycleHooks[e]?this._lifeCycleHooks[e].push(t):this._lifeCycleHooks[e]=[t],this}exitOverride(e){return e?this._exitCallback=e:this._exitCallback=t=>{if(t.code!=="commander.executeSubCommandAsync")throw t},this}_exit(e,t,i){this._exitCallback&&this._exitCallback(new de(e,t,i)),p.exit(e)}action(e){let t=i=>{let r=this.registeredArguments.length,s=i.slice(0,r);return this._storeOptionsAsProperties?s[r]=this:s[r]=this.opts(),s.push(this),e.apply(this,s)};return this._actionHandler=t,this}createOption(e,t){return new Ie(e,t)}_callParseArg(e,t,i,r){try{return e.parseArg(t,i)}catch(s){if(s.code==="commander.invalidArgument"){let o=`${r} ${s.message}`;this.error(o,{exitCode:s.exitCode,code:s.code})}throw s}}_registerOption(e){let t=e.short&&this._findOption(e.short)||e.long&&this._findOption(e.long);if(t){let i=e.long&&this._findOption(e.long)?e.long:e.short;throw new Error(`Cannot add option '${e.flags}'${this._name&&` to command '${this._name}'`} due to conflicting flag '${i}'
-  already used by option '${t.flags}'`)}this.options.push(e)}_registerCommand(e){let t=r=>[r.name()].concat(r.aliases()),i=t(e).find(r=>this._findCommand(r));if(i){let r=t(this._findCommand(i)).join("|"),s=t(e).join("|");throw new Error(`cannot add command '${s}' as already have command '${r}'`)}this.commands.push(e)}addOption(e){this._registerOption(e);let t=e.name(),i=e.attributeName();if(e.negate){let s=e.long.replace(/^--no-/,"--");this._findOption(s)||this.setOptionValueWithSource(i,e.defaultValue===void 0?!0:e.defaultValue,"default")}else e.defaultValue!==void 0&&this.setOptionValueWithSource(i,e.defaultValue,"default");let r=(s,o,c)=>{s==null&&e.presetArg!==void 0&&(s=e.presetArg);let a=this.getOptionValue(i);s!==null&&e.parseArg?s=this._callParseArg(e,s,a,o):s!==null&&e.variadic&&(s=e._concatValue(s,a)),s==null&&(e.negate?s=!1:e.isBoolean()||e.optional?s=!0:s=""),this.setOptionValueWithSource(i,s,c)};return this.on("option:"+t,s=>{let o=`error: option '${e.flags}' argument '${s}' is invalid.`;r(s,o,"cli")}),e.envVar&&this.on("optionEnv:"+t,s=>{let o=`error: option '${e.flags}' value '${s}' from env '${e.envVar}' is invalid.`;r(s,o,"env")}),this}_optionEx(e,t,i,r,s){if(typeof t=="object"&&t instanceof Ie)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");let o=this.createOption(t,i);if(o.makeOptionMandatory(!!e.mandatory),typeof r=="function")o.default(s).argParser(r);else if(r instanceof RegExp){let c=r;r=(a,l)=>{let u=c.exec(a);return u?u[0]:l},o.default(s).argParser(r)}else o.default(r);return this.addOption(o)}option(e,t,i,r){return this._optionEx({},e,t,i,r)}requiredOption(e,t,i,r){return this._optionEx({mandatory:!0},e,t,i,r)}combineFlagAndOptionalValue(e=!0){return this._combineFlagAndOptionalValue=!!e,this}allowUnknownOption(e=!0){return this._allowUnknownOption=!!e,this}allowExcessArguments(e=!0){return this._allowExcessArguments=!!e,this}enablePositionalOptions(e=!0){return this._enablePositionalOptions=!!e,this}passThroughOptions(e=!0){return this._passThroughOptions=!!e,this._checkForBrokenPassThrough(),this}_checkForBrokenPassThrough(){if(this.parent&&this._passThroughOptions&&!this.parent._enablePositionalOptions)throw new Error(`passThroughOptions cannot be used for '${this._name}' without turning on enablePositionalOptions for parent command(s)`)}storeOptionsAsProperties(e=!0){if(this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");if(Object.keys(this._optionValues).length)throw new Error("call .storeOptionsAsProperties() before setting option values");return this._storeOptionsAsProperties=!!e,this}getOptionValue(e){return this._storeOptionsAsProperties?this[e]:this._optionValues[e]}setOptionValue(e,t){return this.setOptionValueWithSource(e,t,void 0)}setOptionValueWithSource(e,t,i){return this._storeOptionsAsProperties?this[e]=t:this._optionValues[e]=t,this._optionValueSources[e]=i,this}getOptionValueSource(e){return this._optionValueSources[e]}getOptionValueSourceWithGlobals(e){let t;return this._getCommandAndAncestors().forEach(i=>{i.getOptionValueSource(e)!==void 0&&(t=i.getOptionValueSource(e))}),t}_prepareUserArgs(e,t){if(e!==void 0&&!Array.isArray(e))throw new Error("first parameter to parse must be array or undefined");if(t=t||{},e===void 0&&t.from===void 0){p.versions?.electron&&(t.from="electron");let r=p.execArgv??[];(r.includes("-e")||r.includes("--eval")||r.includes("-p")||r.includes("--print"))&&(t.from="eval")}e===void 0&&(e=p.argv),this.rawArgs=e.slice();let i;switch(t.from){case void 0:case"node":this._scriptPath=e[1],i=e.slice(2);break;case"electron":p.defaultApp?(this._scriptPath=e[1],i=e.slice(2)):i=e.slice(1);break;case"user":i=e.slice(0);break;case"eval":i=e.slice(1);break;default:throw new Error(`unexpected parse option { from: '${t.from}' }`)}return!this._name&&this._scriptPath&&this.nameFromFilename(this._scriptPath),this._name=this._name||"program",i}parse(e,t){let i=this._prepareUserArgs(e,t);return this._parseCommand([],i),this}async parseAsync(e,t){let i=this._prepareUserArgs(e,t);return await this._parseCommand([],i),this}_executeSubCommand(e,t){t=t.slice();let i=!1,r=[".js",".ts",".tsx",".mjs",".cjs"];function s(u,h){let C=b.resolve(u,h);if(pe.existsSync(C))return C;if(r.includes(b.extname(h)))return;let R=r.find(d=>pe.existsSync(`${C}${d}`));if(R)return`${C}${R}`}this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let o=e._executableFile||`${this._name}-${e._name}`,c=this._executableDir||"";if(this._scriptPath){let u;try{u=pe.realpathSync(this._scriptPath)}catch{u=this._scriptPath}c=b.resolve(b.dirname(u),c)}if(c){let u=s(c,o);if(!u&&!e._executableFile&&this._scriptPath){let h=b.basename(this._scriptPath,b.extname(this._scriptPath));h!==this._name&&(u=s(c,`${h}-${e._name}`))}o=u||o}i=r.includes(b.extname(o));let a;p.platform!=="win32"?i?(t.unshift(o),t=He(p.execArgv).concat(t),a=me.spawn(p.argv[0],t,{stdio:"inherit"})):a=me.spawn(o,t,{stdio:"inherit"}):(t.unshift(o),t=He(p.execArgv).concat(t),a=me.spawn(p.execPath,t,{stdio:"inherit"})),a.killed||["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach(h=>{p.on(h,()=>{a.killed===!1&&a.exitCode===null&&a.kill(h)})});let l=this._exitCallback;a.on("close",u=>{u=u??1,l?l(new de(u,"commander.executeSubCommandAsync","(close)")):p.exit(u)}),a.on("error",u=>{if(u.code==="ENOENT"){let h=c?`searched for local subcommand relative to directory '${c}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",C=`'${o}' does not exist
 - if '${e._name}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${h}`;throw new Error(C)}else if(u.code==="EACCES")throw new Error(`'${o}' not executable`);if(!l)p.exit(1);else{let h=new de(1,"commander.executeSubCommandAsync","(error)");h.nestedError=u,l(h)}}),this.runningCommand=a}_dispatchSubcommand(e,t,i){let r=this._findCommand(e);r||this.help({error:!0});let s;return s=this._chainOrCallSubCommandHook(s,r,"preSubcommand"),s=this._chainOrCall(s,()=>{if(r._executableHandler)this._executeSubCommand(r,t.concat(i));else return r._parseCommand(t,i)}),s}_dispatchHelpCommand(e){e||this.help();let t=this._findCommand(e);return t&&!t._executableHandler&&t.help(),this._dispatchSubcommand(e,[],[this._getHelpOption()?.long??this._getHelpOption()?.short??"--help"])}_checkNumberOfArguments(){this.registeredArguments.forEach((e,t)=>{e.required&&this.args[t]==null&&this.missingArgument(e.name())}),!(this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic)&&this.args.length>this.registeredArguments.length&&this._excessArguments(this.args)}_processArguments(){let e=(i,r,s)=>{let o=r;if(r!==null&&i.parseArg){let c=`error: command-argument value '${r}' is invalid for argument '${i.name()}'.`;o=this._callParseArg(i,r,s,c)}return o};this._checkNumberOfArguments();let t=[];this.registeredArguments.forEach((i,r)=>{let s=i.defaultValue;i.variadic?r<this.args.length?(s=this.args.slice(r),i.parseArg&&(s=s.reduce((o,c)=>e(i,c,o),i.defaultValue))):s===void 0&&(s=[]):r<this.args.length&&(s=this.args[r],i.parseArg&&(s=e(i,s,i.defaultValue))),t[r]=s}),this.processedArgs=t}_chainOrCall(e,t){return e&&e.then&&typeof e.then=="function"?e.then(()=>t()):t()}_chainOrCallHooks(e,t){let i=e,r=[];return this._getCommandAndAncestors().reverse().filter(s=>s._lifeCycleHooks[t]!==void 0).forEach(s=>{s._lifeCycleHooks[t].forEach(o=>{r.push({hookedCommand:s,callback:o})})}),t==="postAction"&&r.reverse(),r.forEach(s=>{i=this._chainOrCall(i,()=>s.callback(s.hookedCommand,this))}),i}_chainOrCallSubCommandHook(e,t,i){let r=e;return this._lifeCycleHooks[i]!==void 0&&this._lifeCycleHooks[i].forEach(s=>{r=this._chainOrCall(r,()=>s(this,t))}),r}_parseCommand(e,t){let i=this.parseOptions(t);if(this._parseOptionsEnv(),this._parseOptionsImplied(),e=e.concat(i.operands),t=i.unknown,this.args=e.concat(t),e&&this._findCommand(e[0]))return this._dispatchSubcommand(e[0],e.slice(1),t);if(this._getHelpCommand()&&e[0]===this._getHelpCommand().name())return this._dispatchHelpCommand(e[1]);if(this._defaultCommandName)return this._outputHelpIfRequested(t),this._dispatchSubcommand(this._defaultCommandName,e,t);this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName&&this.help({error:!0}),this._outputHelpIfRequested(i.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let r=()=>{i.unknown.length>0&&this.unknownOption(i.unknown[0])},s=`command:${this.name()}`;if(this._actionHandler){r(),this._processArguments();let o;return o=this._chainOrCallHooks(o,"preAction"),o=this._chainOrCall(o,()=>this._actionHandler(this.processedArgs)),this.parent&&(o=this._chainOrCall(o,()=>{this.parent.emit(s,e,t)})),o=this._chainOrCallHooks(o,"postAction"),o}if(this.parent&&this.parent.listenerCount(s))r(),this._processArguments(),this.parent.emit(s,e,t);else if(e.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",e,t);this.listenerCount("command:*")?this.emit("command:*",e,t):this.commands.length?this.unknownCommand():(r(),this._processArguments())}else this.commands.length?(r(),this.help({error:!0})):(r(),this._processArguments())}_findCommand(e){if(e)return this.commands.find(t=>t._name===e||t._aliases.includes(e))}_findOption(e){return this.options.find(t=>t.is(e))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach(e=>{e.options.forEach(t=>{t.mandatory&&e.getOptionValue(t.attributeName())===void 0&&e.missingMandatoryOptionValue(t)})})}_checkForConflictingLocalOptions(){let e=this.options.filter(i=>{let r=i.attributeName();return this.getOptionValue(r)===void 0?!1:this.getOptionValueSource(r)!=="default"});e.filter(i=>i.conflictsWith.length>0).forEach(i=>{let r=e.find(s=>i.conflictsWith.includes(s.attributeName()));r&&this._conflictingOption(i,r)})}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach(e=>{e._checkForConflictingLocalOptions()})}parseOptions(e){let t=[],i=[],r=t,s=e.slice();function o(a){return a.length>1&&a[0]==="-"}let c=null;for(;s.length;){let a=s.shift();if(a==="--"){r===i&&r.push(a),r.push(...s);break}if(c&&!o(a)){this.emit(`option:${c.name()}`,a);continue}if(c=null,o(a)){let l=this._findOption(a);if(l){if(l.required){let u=s.shift();u===void 0&&this.optionMissingArgument(l),this.emit(`option:${l.name()}`,u)}else if(l.optional){let u=null;s.length>0&&!o(s[0])&&(u=s.shift()),this.emit(`option:${l.name()}`,u)}else this.emit(`option:${l.name()}`);c=l.variadic?l:null;continue}}if(a.length>2&&a[0]==="-"&&a[1]!=="-"){let l=this._findOption(`-${a[1]}`);if(l){l.required||l.optional&&this._combineFlagAndOptionalValue?this.emit(`option:${l.name()}`,a.slice(2)):(this.emit(`option:${l.name()}`),s.unshift(`-${a.slice(2)}`));continue}}if(/^--[^=]+=/.test(a)){let l=a.indexOf("="),u=this._findOption(a.slice(0,l));if(u&&(u.required||u.optional)){this.emit(`option:${u.name()}`,a.slice(l+1));continue}}if(o(a)&&(r=i),(this._enablePositionalOptions||this._passThroughOptions)&&t.length===0&&i.length===0){if(this._findCommand(a)){t.push(a),s.length>0&&i.push(...s);break}else if(this._getHelpCommand()&&a===this._getHelpCommand().name()){t.push(a),s.length>0&&t.push(...s);break}else if(this._defaultCommandName){i.push(a),s.length>0&&i.push(...s);break}}if(this._passThroughOptions){r.push(a),s.length>0&&r.push(...s);break}r.push(a)}return{operands:t,unknown:i}}opts(){if(this._storeOptionsAsProperties){let e={},t=this.options.length;for(let i=0;i<t;i++){let r=this.options[i].attributeName();e[r]=r===this._versionOptionName?this._version:this[r]}return e}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce((e,t)=>Object.assign(e,t.opts()),{})}error(e,t){this._outputConfiguration.outputError(`${e}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError=="string"?this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`):this._showHelpAfterError&&(this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0}));let i=t||{},r=i.exitCode||1,s=i.code||"commander.error";this._exit(r,s,e)}_parseOptionsEnv(){this.options.forEach(e=>{if(e.envVar&&e.envVar in p.env){let t=e.attributeName();(this.getOptionValue(t)===void 0||["default","config","env"].includes(this.getOptionValueSource(t)))&&(e.required||e.optional?this.emit(`optionEnv:${e.name()}`,p.env[e.envVar]):this.emit(`optionEnv:${e.name()}`))}})}_parseOptionsImplied(){let e=new Xt(this.options),t=i=>this.getOptionValue(i)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(i));this.options.filter(i=>i.implied!==void 0&&t(i.attributeName())&&e.valueFromOption(this.getOptionValue(i.attributeName()),i)).forEach(i=>{Object.keys(i.implied).filter(r=>!t(r)).forEach(r=>{this.setOptionValueWithSource(r,i.implied[r],"implied")})})}missingArgument(e){let t=`error: missing required argument '${e}'`;this.error(t,{code:"commander.missingArgument"})}optionMissingArgument(e){let t=`error: option '${e.flags}' argument missing`;this.error(t,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(e){let t=`error: required option '${e.flags}' not specified`;this.error(t,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(e,t){let i=o=>{let c=o.attributeName(),a=this.getOptionValue(c),l=this.options.find(h=>h.negate&&c===h.attributeName()),u=this.options.find(h=>!h.negate&&c===h.attributeName());return l&&(l.presetArg===void 0&&a===!1||l.presetArg!==void 0&&a===l.presetArg)?l:u||o},r=o=>{let c=i(o),a=c.attributeName();return this.getOptionValueSource(a)==="env"?`environment variable '${c.envVar}'`:`option '${c.flags}'`},s=`error: ${r(e)} cannot be used with ${r(t)}`;this.error(s,{code:"commander.conflictingOption"})}unknownOption(e){if(this._allowUnknownOption)return;let t="";if(e.startsWith("--")&&this._showSuggestionAfterError){let r=[],s=this;do{let o=s.createHelp().visibleOptions(s).filter(c=>c.long).map(c=>c.long);r=r.concat(o),s=s.parent}while(s&&!s._enablePositionalOptions);t=Me(e,r)}let i=`error: unknown option '${e}'${t}`;this.error(i,{code:"commander.unknownOption"})}_excessArguments(e){if(this._allowExcessArguments)return;let t=this.registeredArguments.length,i=t===1?"":"s",s=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${t} argument${i} but got ${e.length}.`;this.error(s,{code:"commander.excessArguments"})}unknownCommand(){let e=this.args[0],t="";if(this._showSuggestionAfterError){let r=[];this.createHelp().visibleCommands(this).forEach(s=>{r.push(s.name()),s.alias()&&r.push(s.alias())}),t=Me(e,r)}let i=`error: unknown command '${e}'${t}`;this.error(i,{code:"commander.unknownCommand"})}version(e,t,i){if(e===void 0)return this._version;this._version=e,t=t||"-V, --version",i=i||"output the version number";let r=this.createOption(t,i);return this._versionOptionName=r.attributeName(),this._registerOption(r),this.on("option:"+r.name(),()=>{this._outputConfiguration.writeOut(`${e}
`),this._exit(0,"commander.version",e)}),this}description(e,t){return e===void 0&&t===void 0?this._description:(this._description=e,t&&(this._argsDescription=t),this)}summary(e){return e===void 0?this._summary:(this._summary=e,this)}alias(e){if(e===void 0)return this._aliases[0];let t=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler&&(t=this.commands[this.commands.length-1]),e===t._name)throw new Error("Command alias can't be the same as its name");let i=this.parent?._findCommand(e);if(i){let r=[i.name()].concat(i.aliases()).join("|");throw new Error(`cannot add alias '${e}' to command '${this.name()}' as already have command '${r}'`)}return t._aliases.push(e),this}aliases(e){return e===void 0?this._aliases:(e.forEach(t=>this.alias(t)),this)}usage(e){if(e===void 0){if(this._usage)return this._usage;let t=this.registeredArguments.map(i=>jt(i));return[].concat(this.options.length||this._helpOption!==null?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?t:[]).join(" ")}return this._usage=e,this}name(e){return e===void 0?this._name:(this._name=e,this)}nameFromFilename(e){return this._name=b.basename(e,b.extname(e)),this}executableDir(e){return e===void 0?this._executableDir:(this._executableDir=e,this)}helpInformation(e){let t=this.createHelp();return t.helpWidth===void 0&&(t.helpWidth=e&&e.error?this._outputConfiguration.getErrHelpWidth():this._outputConfiguration.getOutHelpWidth()),t.formatHelp(this,t)}_getHelpContext(e){e=e||{};let t={error:!!e.error},i;return t.error?i=r=>this._outputConfiguration.writeErr(r):i=r=>this._outputConfiguration.writeOut(r),t.write=e.write||i,t.command=this,t}outputHelp(e){let t;typeof e=="function"&&(t=e,e=void 0);let i=this._getHelpContext(e);this._getCommandAndAncestors().reverse().forEach(s=>s.emit("beforeAllHelp",i)),this.emit("beforeHelp",i);let r=this.helpInformation(i);if(t&&(r=t(r),typeof r!="string"&&!Buffer.isBuffer(r)))throw new Error("outputHelp callback must return a string or a Buffer");i.write(r),this._getHelpOption()?.long&&this.emit(this._getHelpOption().long),this.emit("afterHelp",i),this._getCommandAndAncestors().forEach(s=>s.emit("afterAllHelp",i))}helpOption(e,t){return typeof e=="boolean"?(e?this._helpOption=this._helpOption??void 0:this._helpOption=null,this):(e=e??"-h, --help",t=t??"display help for command",this._helpOption=this.createOption(e,t),this)}_getHelpOption(){return this._helpOption===void 0&&this.helpOption(void 0,void 0),this._helpOption}addHelpOption(e){return this._helpOption=e,this}help(e){this.outputHelp(e);let t=p.exitCode||0;t===0&&e&&typeof e!="function"&&e.error&&(t=1),this._exit(t,"commander.help","(outputHelp)")}addHelpText(e,t){let i=["beforeAll","before","after","afterAll"];if(!i.includes(e))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${i.join("', '")}'`);let r=`${e}Help`;return this.on(r,s=>{let o;typeof t=="function"?o=t({error:s.error,command:s.command}):o=t,o&&s.write(`${o}
`)}),this}_outputHelpIfRequested(e){let t=this._getHelpOption();t&&e.find(r=>t.is(r))&&(this.outputHelp(),this._exit(0,"commander.helpDisplayed","(outputHelp)"))}};function He(n){return n.map(e=>{if(!e.startsWith("--inspect"))return e;let t,i="127.0.0.1",r="9229",s;return(s=e.match(/^(--inspect(-brk)?)$/))!==null?t=s[1]:(s=e.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null?(t=s[1],/^\d+$/.test(s[3])?r=s[3]:i=s[3]):(s=e.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null&&(t=s[1],i=s[3],r=s[4]),t&&r!=="0"?`${t}=${i}:${parseInt(r)+1}`:e})}De.Command=ge});var Ue=y(A=>{var{Argument:Ve}=U(),{Command:_e}=Le(),{CommanderError:Qt,InvalidArgumentError:Fe}=M(),{Help:Kt}=ce(),{Option:$e}=fe();A.program=new _e;A.createCommand=n=>new _e(n);A.createOption=(n,e)=>new $e(n,e);A.createArgument=(n,e)=>new Ve(n,e);A.Command=_e;A.Option=$e;A.Argument=Ve;A.Help=Kt;A.CommanderError=Qt;A.InvalidArgumentError=Fe;A.InvalidOptionArgumentError=Fe});var We=y((O,qe)=>{var S=Ue();O=qe.exports={};O.program=new S.Command;O.Argument=S.Argument;O.Command=S.Command;O.CommanderError=S.CommanderError;O.Help=S.Help;O.InvalidArgumentError=S.InvalidArgumentError;O.InvalidOptionArgumentError=S.InvalidArgumentError;O.Option=S.Option;O.createCommand=n=>new S.Command(n);O.createOption=(n,e)=>new S.Option(n,e);O.createArgument=(n,e)=>new S.Argument(n,e)});var Ce=y((Gi,Ye)=>{function zt(){Object.defineProperties(this,{data:{enumerable:!0,get:i,set:o},type:{enumerable:!0,get:t,set:s},load:{enumerable:!0,writable:!1,value:c},JSON:{enumerable:!0,get:r}});var n="",e={};function t(){return n}function i(){return e}function r(){return JSON.stringify({type:n,data:e})}function s(a){n=a}function o(a){e=a}function c(a){try{var a=JSON.parse(a);n=a.type,e=a.data}catch(u){var l=a;n="error",e={message:"Invalid JSON response format",err:u,response:l}}}}Ye.exports=zt});var Qe=y((Bi,Xe)=>{function Zt(n){Object.defineProperties(this,{add:{enumerable:!0,writable:!1,value:c},next:{enumerable:!0,writable:!1,value:a},clear:{enumerable:!0,writable:!1,value:r},contents:{enumerable:!1,get:s,set:o},autoRun:{enumerable:!0,writable:!0,value:!0},stop:{enumerable:!0,writable:!0,value:!1}});var e=[],t=!1,i=!1;function r(){return e=[],e}function s(){return e}function o(l){return e=l,e}function c(){for(var l in arguments)e.push(arguments[l]);!t&&!this.stop&&this.autoRun&&this.next()}function a(){if(t=!0,e.length<1||this.stop){t=!1;return}e.shift().bind(this)()}}Xe.exports=Zt});var Nt=_(require("node:process"));var xt=_(require("node:process"));var Ge=_(We(),1),{program:ki,createCommand:Ii,createArgument:Mi,createOption:Hi,CommanderError:Di,InvalidArgumentError:Li,InvalidOptionArgumentError:Vi,Command:Be,Argument:q,Option:je,Help:Fi}=Ge.default;var Ee=_(require("os"),1),P=class{constructor(){}appspace="app.";socketRoot="/tmp/";id=Ee.default.hostname();encoding="utf8";rawBuffer=!1;sync=!1;unlink=!0;delimiter="\f";silent=!1;logDepth=5;logInColor=!0;logger=console.log.bind(console);maxConnections=100;retry=500;maxRetries=1/0;stopRetrying=!1;IPType=Jt();tls=!1;networkHost=this.IPType=="IPv6"?"::1":"127.0.0.1";networkPort=8e3;readableAll=!1;writableAll=!1;interface={localAddress:!1,localPort:!1,family:!1,hints:!1,lookup:!1}};function Jt(){let n=Ee.default.networkInterfaces(),e="";return n&&Array.isArray(n)&&n.length>0&&(e=n[Object.keys(n)[0]][0].family),e}var Ae=_(require("net"),1),Ke=_(require("tls"),1);var v=class{constructor(e){e||(e=new P),this.delimiter=e.delimiter}format(e){return!e.data&&e.data!==!1&&e.data!==0&&(e.data={}),e.data._maxListeners&&(e.data={}),e=e.JSON+this.delimiter,e}parse(e){let t=e.split(this.delimiter);return t.pop(),t}};var Se=_(Ce(),1),B=_(require("fs"),1),Je=_(Qe(),1);var W=class{},Oe=class{},G=class n{constructor(e=!0){this.strict=e}throw(e,t){let i=new TypeError;if(i.message=`expected type of ${e} to be ${t}`,!this.strict)return!1;throw i}typeCheck(e,t){return typeof e===t?!0:this.throw(typeof e,t)}instanceCheck(e=new W,t=Oe){return e instanceof t?!0:this.throw(typeof e,t.name)}symbolStringCheck(e,t){return Object.prototype.toString.call(e)==`[object ${t}]`?!0:this.throw(Object.prototype.toString.call(e),`[object ${t}]`)}compare(e,t,i){return e==t?!0:this.throw(typeof e,i)}defined(e){return new n(!1).undefined(e)?this.throw("undefined","defined"):!0}any(e){return this.defined(e)}exists(e){return this.defined(e)}union(e,t){let i=t.split("|"),r=new n(!1),s=!1,o="undefined";for(o of i)try{if(r[o](e)){s=!0;break}}catch{return this.throw(o,"a method available on strong-type")}return s?this[o](e):this.throw(typeof e,i.join("|"))}finite(e){return isFinite(e)?!0:this.throw(typeof e,"finite")}NaN(e){return this.number(e)?isNaN(e)?!0:this.throw(typeof e,"NaN"):this.number(e)}null(e){return this.compare(e,null,"null")}array(e){return this.instanceCheck(e,Array)}boolean(e){return this.typeCheck(e,"boolean")}bigInt(e){return this.typeCheck(e,"bigint")}date(e){return this.instanceCheck(e,Date)}generator(e){return this.symbolStringCheck(e,"Generator")}asyncGenerator(e){return this.symbolStringCheck(e,"AsyncGenerator")}globalThis(e){return this.compare(e,globalThis,"explicitly globalThis, not window, global nor self")}infinity(e){return this.compare(e,1/0,"Infinity")}map(e){return this.instanceCheck(e,Map)}weakMap(e){return this.instanceCheck(e,WeakMap)}number(e){return this.typeCheck(e,"number")}object(e){return this.typeCheck(e,"object")}promise(e){return this.instanceCheck(e,Promise)}regExp(e){return this.instanceCheck(e,RegExp)}undefined(e){return this.typeCheck(e,"undefined")}set(e){return this.instanceCheck(e,Set)}weakSet(e){return this.instanceCheck(e,WeakSet)}string(e){return this.typeCheck(e,"string")}symbol(e){return this.typeCheck(e,"symbol")}function(e){return this.typeCheck(e,"function")}asyncFunction(e){return this.symbolStringCheck(e,"AsyncFunction")}generatorFunction(e){return this.symbolStringCheck(e,"GeneratorFunction")}asyncGeneratorFunction(e){return this.symbolStringCheck(e,"AsyncGeneratorFunction")}error(e){return this.instanceCheck(e,Error)}evalError(e){return this.instanceCheck(e,EvalError)}rangeError(e){return this.instanceCheck(e,RangeError)}referenceError(e){return this.instanceCheck(e,ReferenceError)}syntaxError(e){return this.instanceCheck(e,SyntaxError)}typeError(e){return this.instanceCheck(e,TypeError)}URIError(e){return this.instanceCheck(e,URIError)}bigInt64Array(e){return this.instanceCheck(e,BigInt64Array)}bigUint64Array(e){return this.instanceCheck(e,BigUint64Array)}float32Array(e){return this.instanceCheck(e,Float32Array)}float64Array(e){return this.instanceCheck(e,Float64Array)}int8Array(e){return this.instanceCheck(e,Int8Array)}int16Array(e){return this.instanceCheck(e,Int16Array)}int32Array(e){return this.instanceCheck(e,Int32Array)}uint8Array(e){return this.instanceCheck(e,Uint8Array)}uint8ClampedArray(e){return this.instanceCheck(e,Uint8ClampedArray)}uint16Array(e){return this.instanceCheck(e,Uint16Array)}uint32Array(e){return this.instanceCheck(e,Uint32Array)}arrayBuffer(e){return this.instanceCheck(e,ArrayBuffer)}dataView(e){return this.instanceCheck(e,DataView)}sharedArrayBuffer(e){return this.instanceCheck(e,function(){try{return SharedArrayBuffer}catch{return W}}())}intlDateTimeFormat(e){return this.instanceCheck(e,Intl.DateTimeFormat)}intlCollator(e){return this.instanceCheck(e,Intl.Collator)}intlDisplayNames(e){return this.instanceCheck(e,Intl.DisplayNames)}intlListFormat(e){return this.instanceCheck(e,Intl.ListFormat)}intlLocale(e){return this.instanceCheck(e,Intl.Locale)}intlNumberFormat(e){return this.instanceCheck(e,Intl.NumberFormat)}intlPluralRules(e){return this.instanceCheck(e,Intl.PluralRules)}intlRelativeTimeFormat(e){return this.instanceCheck(e,Intl.RelativeTimeFormat)}intlRelativeTimeFormat(e){return this.instanceCheck(e,Intl.RelativeTimeFormat)}finalizationRegistry(e){return this.instanceCheck(e,FinalizationRegistry)}weakRef(e){return this.instanceCheck(e,WeakRef)}};var x=new G,k=class{constructor(){}on(e,t,i=!1){return x.string(e),x.function(t),x.boolean(i),e=="*"&&(e=this.#t),this.#e[e]||(this.#e[e]=[]),t[this.#n]=i,this.#e[e].push(t),this}once(e,t){return this.on(e,t,!0)}off(e="*",t="*"){if(x.string(e),(e==this.#t.toString()||e=="*")&&(e=this.#t),!this.#e[e])return this;if(t=="*")return delete this.#e[e],this;x.function(t);let i=this.#e[e];for(;i.includes(t);)i.splice(i.indexOf(t),1);return i.length<1&&delete this.#e[e],this}emit(e,...t){x.string(e);let i=this.#e[this.#t]||[];if(this.#i(this.#t.toString(),i,e,...t),!this.#e[e])return this;let r=this.#e[e];return this.#i(e,r,...t),this}reset(){this.off(this.#t.toString());for(let e in this.#e)this.off(e);return this}get list(){return Object.assign({},this.#e)}#i=(e,t,...i)=>{x.string(e),x.array(t);let r=[];for(let s of t)s(...i),s[this.#n]&&r.push(s);for(let s of r)this.off(e,s)};#t=Symbol.for("event-pubsub-all");#n=Symbol.for("event-pubsub-once");#e={}};var H=new v,D=class n extends k{constructor(e,t){super(),this.config=e,this.log=t,this.publish=super.emit,e.maxRetries&&(this.retriesRemaining=e.maxRetries),H=new v(this.config)}Client=n;queue=new Je.default;socket=!1;connect=ii;emit=ei;retriesRemaining=0;explicitlyDisconnected=!1};function ei(n,e){this.log("dispatching event to ",this.id,this.path," : ",n,",",e);let t=new Se.default;if(t.type=n,t.data=e,this.config.rawBuffer?t=Buffer.from(n,this.config.encoding):t=H.format(t),!this.config.sync){this.socket.write(t);return}this.queue.add(ti.bind(this,t))}function ti(n){this.log("dispatching event to ",this.id,this.path," : ",n),this.socket.write(n)}function ii(){let n=this;if(n.log("requested connection to ",n.id,n.path),!this.path){n.log(`

######
error: `,n.id," client has not specified socket path it wishes to connect to.");return}let e={};if(!n.port)n.log("Connecting client on Unix Socket :",n.path),e.path=n.path,process.platform==="win32"&&!n.path.startsWith("\\\\.\\pipe\\")&&(e.path=e.path.replace(/^\//,""),e.path=e.path.replace(/\//g,"-"),e.path=`\\\\.\\pipe\\${e.path}`),n.socket=Ae.default.connect(e);else if(e.host=n.path,e.port=n.port,n.config.interface.localAddress&&(e.localAddress=n.config.interface.localAddress),n.config.interface.localPort&&(e.localPort=n.config.interface.localPort),n.config.interface.family&&(e.family=n.config.interface.family),n.config.interface.hints&&(e.hints=n.config.interface.hints),n.config.interface.lookup&&(e.lookup=n.config.interface.lookup),!n.config.tls)n.log("Connecting client via TCP to",e),n.socket=Ae.default.connect(e);else{if(n.log("Connecting client via TLS to",n.path,n.port,n.config.tls),n.config.tls.private&&(n.config.tls.key=B.default.readFileSync(n.config.tls.private)),n.config.tls.public&&(n.config.tls.cert=B.default.readFileSync(n.config.tls.public)),n.config.tls.trustedConnections){typeof n.config.tls.trustedConnections=="string"&&(n.config.tls.trustedConnections=[n.config.tls.trustedConnections]),n.config.tls.ca=[];for(let t=0;t<n.config.tls.trustedConnections.length;t++)n.config.tls.ca.push(B.default.readFileSync(n.config.tls.trustedConnections[t]))}Object.assign(n.config.tls,e),n.socket=Ke.default.connect(n.config.tls)}n.socket.setEncoding(this.config.encoding),n.socket.on("error",function(t){n.log(`

######
error: `,t),n.publish("error",t)}),n.socket.on("connect",function(){n.publish("connect"),n.retriesRemaining=n.config.maxRetries,n.log("retrying reset")}),n.socket.on("close",function(){if(n.log("connection closed",n.id,n.path,n.retriesRemaining,"tries remaining of",n.config.maxRetries),n.config.stopRetrying||n.retriesRemaining<1||n.explicitlyDisconnected){n.publish("disconnect"),n.log(n.config.id,"exceeded connection rety amount of"," or stopRetrying flag set."),n.socket.destroy(),n.publish("destroy"),n=void 0;return}setTimeout(function(){n.explicitlyDisconnected||(n.retriesRemaining--,n.connect())}.bind(null,n),n.config.retry),n.publish("disconnect")}),n.socket.on("data",function(t){if(n.log("## received events ##"),n.config.rawBuffer){if(n.publish("data",Buffer.from(t,n.config.encoding)),!n.config.sync)return;n.queue.next();return}if(this.ipcBuffer||(this.ipcBuffer=""),t=this.ipcBuffer+=t,t.slice(-1)!=H.delimiter||t.indexOf(H.delimiter)==-1){n.log("Messages are large, You may want to consider smaller messages.");return}this.ipcBuffer="";let i=H.parse(t),r=i.length;for(let s=0;s<r;s++){let o=new Se.default;o.load(i[s]),n.log("detected event",o.type,o.data),n.publish(o.type,o.data)}n.config.sync&&n.queue.next()})}var Ze=_(require("net"),1),et=_(require("tls"),1),N=_(require("fs"),1),tt=_(require("dgram"),1);var j=_(Ce(),1);var I=new v,L=class extends k{constructor(e,t,i,r){super(),this.config=t,this.path=e,this.port=r,this.log=i,this.publish=super.emit,I=new v(this.config),this.on("close",si.bind(this))}udp4=!1;udp6=!1;server=!1;sockets=[];emit=ni;broadcast=ri;onStart(e){this.publish("start",e)}stop(){this.server.close()}start(){if(!this.path){this.log("Socket Server Path not specified, refusing to start");return}this.config.unlink?N.default.unlink(this.path,ze.bind(this)):ze.bind(this)()}};function ni(n,e,t){this.log("dispatching event to socket"," : ",e,t);let i=new j.default;if(i.type=e,i.data=t,this.config.rawBuffer?(this.log(this.config.encoding),i=Buffer.from(e,this.config.encoding)):i=I.format(i),this.udp4||this.udp6){if(!n.address||!n.port){this.log("Attempting to emit to a single UDP socket without supplying socket address or port. Redispatching event as broadcast to all connected sockets"),this.broadcast(e,t);return}this.server.write(i,n);return}n.write(i)}function ri(n,e){this.log("broadcasting event to all known sockets listening to ",this.path," : ",this.port?this.port:"",n,e);let t=new j.default;if(t.type=n,t.data=e,this.config.rawBuffer?t=Buffer.from(n,this.config.encoding):t=I.format(t),this.udp4||this.udp6)for(let i=1,r=this.sockets.length;i<r;i++)this.server.write(t,this.sockets[i]);else for(let i=0,r=this.sockets.length;i<r;i++)this.sockets[i].write(t)}function si(){for(let n=0,e=this.sockets.length;n<e;n++){let t=this.sockets[n],i=!1;if(!(t&&t.readable)){t.id&&(i=t.id),this.log("socket disconnected",i.toString()),t&&t.destroy&&t.destroy(),this.sockets.splice(n,1),this.publish("socket.disconnected",t,i);return}}}function oi(n,e,t){let i=this.udp4||this.udp6?t:n;if(this.config.rawBuffer){e=Buffer.from(e,this.config.encoding),this.publish("data",e,i);return}if(i.ipcBuffer||(i.ipcBuffer=""),e=i.ipcBuffer+=e,e.slice(-1)!=I.delimiter||e.indexOf(I.delimiter)==-1){this.log("Messages are large, You may want to consider smaller messages.");return}for(i.ipcBuffer="",e=I.parse(e);e.length>0;){let r=new j.default;r.load(e.shift()),r.data&&r.data.id&&(i.id=r.data.id),this.log("received event of : ",r.type,r.data),this.publish(r.type,r.data,i)}}function ai(n){this.publish("close",n)}function Te(n){this.sockets.push(n),n.setEncoding&&n.setEncoding(this.config.encoding),this.log("## socket connection to server detected ##"),n.on("close",ai.bind(this)),n.on("error",function(e){this.log("server socket error",e),this.publish("error",e)}.bind(this)),n.on("data",oi.bind(this,n)),n.on("message",function(e,t){if(!t)return;this.log("Received UDP message from ",t.address,t.port);let i;this.config.rawSocket?i=Buffer.from(e,this.config.encoding):i=e.toString(),n.emit("data",i,t)}.bind(this)),this.publish("connect",n),this.config.rawBuffer}function ze(){if(this.log("starting server on ",this.path,this.port?`:${this.port}`:""),!this.udp4&&!this.udp6?(this.log("starting TLS server",this.config.tls),this.config.tls?ci.bind(this)():this.server=Ze.default.createServer(Te.bind(this))):(this.server=tt.default.createSocket(this.udp4?"udp4":"udp6"),this.server.write=li.bind(this),this.server.on("listening",function(){Te.bind(this)(this.server)}.bind(this))),this.server.on("error",function(n){this.log("server error",n),this.publish("error",n)}.bind(this)),this.server.maxConnections=this.config.maxConnections,!this.port){this.log("starting server as","Unix || Windows Socket"),process.platform==="win32"&&(this.path=this.path.replace(/^\//,""),this.path=this.path.replace(/\//g,"-"),this.path=`\\\\.\\pipe\\${this.path}`),this.server.listen({path:this.path,readableAll:this.config.readableAll,writableAll:this.config.writableAll},this.onStart.bind(this));return}if(!this.udp4&&!this.udp6){this.log("starting server as",this.config.tls?"TLS":"TCP"),this.server.listen(this.port,this.path,this.onStart.bind(this));return}this.log("starting server as",this.udp4?"udp4":"udp6"),this.server.bind(this.port,this.path),this.onStart({address:this.path,port:this.port})}function ci(){if(this.log("starting TLS server",this.config.tls),this.config.tls.private?this.config.tls.key=N.default.readFileSync(this.config.tls.private):this.config.tls.key=N.default.readFileSync(`${__dirname}/../local-node-ipc-certs/private/server.key`),this.config.tls.public?this.config.tls.cert=N.default.readFileSync(this.config.tls.public):this.config.tls.cert=N.default.readFileSync(`${__dirname}/../local-node-ipc-certs/server.pub`),this.config.tls.dhparam&&(this.config.tls.dhparam=N.default.readFileSync(this.config.tls.dhparam)),this.config.tls.trustedConnections){typeof this.config.tls.trustedConnections=="string"&&(this.config.tls.trustedConnections=[this.config.tls.trustedConnections]),this.config.tls.ca=[];for(let n=0;n<this.config.tls.trustedConnections.length;n++)this.config.tls.ca.push(N.default.readFileSync(this.config.tls.trustedConnections[n]))}this.server=et.default.createServer(this.config.tls,Te.bind(this))}function li(n,e){let t=Buffer.from(n,this.config.encoding);this.server.send(t,0,t.length,e.port,e.address,function(i,r){i&&(this.log("error writing data to socket",i),this.publish("error",function(s){this.publish("error",s)}))})}var at=_(require("util"),1),V=class{constructor(){}config=new P;of={};server=!1;get connectTo(){return st}get connectToNet(){return ot}get disconnect(){return it}get serve(){return nt}get serveNet(){return rt}get log(){return Y}set connectTo(e){return st}set connectToNet(e){return ot}set disconnect(e){return it}set serve(e){return nt}set serveNet(e){return rt}set log(e){return Y}};function Y(...n){if(!this.config.silent){for(let e=0,t=n.length;e<t;e++)typeof n[e]=="object"&&(n[e]=at.default.inspect(n[e],{depth:this.config.logDepth,colors:this.config.logInColor}));this.config.logger(n.join(" "))}}function it(n){this.of[n]&&(this.of[n].explicitlyDisconnected=!0,this.of[n].off("*","*"),this.of[n].socket&&this.of[n].socket.destroy&&this.of[n].socket.destroy(),delete this.of[n])}function nt(n,e){typeof n=="function"&&(e=n,n=!1),n||(this.log("Server path not specified, so defaulting to","ipc.config.socketRoot + ipc.config.appspace + ipc.config.id",this.config.socketRoot+this.config.appspace+this.config.id),n=this.config.socketRoot+this.config.appspace+this.config.id),e||(e=X),this.server=new L(n,this.config,Y),this.server.on("start",e)}function X(){}function rt(n,e,t,i){typeof n=="number"&&(i=t,t=e,e=n,n=!1),typeof n=="function"&&(i=n,t=!1,n=!1,e=!1),n||(this.log("Server host not specified, so defaulting to","ipc.config.networkHost",this.config.networkHost),n=this.config.networkHost),(n.toLowerCase()=="udp4"||n.toLowerCase()=="udp6")&&(i=e,t=n.toLowerCase(),e=!1,n=this.config.networkHost),typeof e=="string"&&(i=t,t=e,e=!1),typeof e=="function"&&(i=e,t=!1,e=!1),e||(this.log("Server port not specified, so defaulting to","ipc.config.networkPort",this.config.networkPort),e=this.config.networkPort),typeof t=="function"&&(i=t,t=!1),i||(i=X),this.server=new L(n,this.config,Y,e),t&&(this.server[t]=!0,t==="udp4"&&n==="::1"&&(this.server.path="127.0.0.1")),this.server.on("start",i)}function st(n,e,t){if(typeof e=="function"&&(t=e,e=!1),t||(t=X),!n){this.log("Service id required","Requested service connection without specifying service id. Aborting connection attempt");return}if(e||(this.log("Service path not specified, so defaulting to","ipc.config.socketRoot + ipc.config.appspace + id",(this.config.socketRoot+this.config.appspace+n).data),e=this.config.socketRoot+this.config.appspace+n),this.of[n]){if(!this.of[n].socket.destroyed){this.log("Already Connected to",n,"- So executing success without connection"),t();return}this.of[n].socket.destroy()}this.of[n]=new D(this.config,this.log),this.of[n].id=n,this.of[n].socket&&(this.of[n].socket.id=n),this.of[n].path=e,this.of[n].connect(),t(this)}function ot(n,e,t,i){if(!n){this.log("Service id required","Requested service connection without specifying service id. Aborting connection attempt");return}if(typeof e=="number"&&(i=t,t=e,e=!1),typeof e=="function"&&(i=e,e=!1,t=!1),e||(this.log("Server host not specified, so defaulting to","ipc.config.networkHost",this.config.networkHost),e=this.config.networkHost),typeof t=="function"&&(i=t,t=!1),t||(this.log("Server port not specified, so defaulting to","ipc.config.networkPort",this.config.networkPort),t=this.config.networkPort),typeof i=="string"&&(UDPType=i,i=!1),i||(i=X),this.of[n]){if(!this.of[n].socket.destroyed){this.log("Already Connected to",n,"- So executing success without connection"),i();return}this.of[n].socket.destroy()}this.of[n]=new D(this.config,this.log),this.of[n].id=n,this.of[n].socket&&(this.of[n].socket.id=n),this.of[n].path=e,this.of[n].port=t,this.of[n].connect(),i(this)}var ye=class extends V{constructor(){super()}IPC=V},f=new ye;var ui={GO_TO_TESTS_CONTEXT_MENU:"early.goToTests.contextMenu",GENERATE_TEST_CONTEXT_MENU:"early.generateTest.contextMenu"},hi={PYTHON_EXTRACT_CODE:"early.python.extractCode",PYTHON_EXTRACT_TESTABLES:"early.python.extractTestables",PYTHON_EXTRACT_TESTABLES_FROM_MULTIPLE_FILES:"early.python.extractTestablesFromMultipleFiles"},T={RELOAD_WINDOW:"workbench.action.reloadWindow",GENERATE_TEST:"early.generateTest",GENERATE_CLASS_TEST:"early.generateClassTest",GENERATE_TESTS_BY_CONFIG:"early.generateTestsByConfig",GENERATE_COVERAGE:"early.generateCoverage",SHOW_LAST_PROMPT:"early.showLastPrompt",ANSWER_PROMPT:"early.answerPrompt",FIX_GREY_TESTS:"early.fixGreyTests",LOG_OUT:"early.logOut",TURN_ON_SKIP_RED_TESTS:"early.turnOnSkipRedTests",TURN_OFF_SKIP_RED_TESTS:"early.turnOffSkipRedTests",REFRESH_TREE_STATE:"early.refreshTreeState",GO_TO_TESTS:"early.goToTests",OPEN_FILE:"early.openFile",UPDATE_EXTENSION:"early.updateExtension",DUMP_EARLY_COVERAGE_PER_METHOD:"early.dumpEarlyCoveragePerMethod",SHOW_ONBOARDING:"early.showOnboarding",INSTALL_CLI:"early.installCLI",OPEN_ONBOARDING_PAGE:"early.openOnboardingPage",OPEN_EARL_PANEL:"early.openEarlPanel",...ui,...hi},be="early";var g="early-extension.cli",m={EVENT_RECEIVED:"EVENT_RECEIVED",COMMAND_REQUEST:"COMMAND_REQUEST",COMMAND_RESPONSE:"COMMAND_RESPONSE",LOGIN_REQUEST:"LOGIN_REQUEST",LOGIN_RESPONSE:"LOGIN_RESPONSE",GENERATE_TEST_SUMMARY_REQUEST:"GENERATE_TEST_SUMMARY_REQUEST",GENERATE_TEST_SUMMARY_RESPONSE:"GENERATE_TEST_SUMMARY_RESPONSE",PING_REQUEST:"PING_REQUEST",PING_RESPONSE:"PING_RESPONSE",PYTHON_EXTRACT_REQUEST:"PYTHON_EXTRACT_REQUEST",PYTHON_EXTRACT_RESPONSE:"PYTHON_EXTRACT_RESPONSE",PYTHON_EXTRACT_TESTABLES_REQUEST:"PYTHON_EXTRACT_TESTABLES_REQUEST",PYTHON_EXTRACT_TESTABLES_RESPONSE:"PYTHON_EXTRACT_TESTABLES_RESPONSE",PYTHON_EXTRACT_TESTABLES_FROM_MULTIPLE_FILES_REQUEST:"PYTHON_EXTRACT_TESTABLES_FROM_MULTIPLE_FILES_REQUEST",PYTHON_EXTRACT_TESTABLES_FROM_MULTIPLE_FILES_RESPONSE:"PYTHON_EXTRACT_TESTABLES_FROM_MULTIPLE_FILES_RESPONSE"},ct=[T.GENERATE_TESTS_BY_CONFIG,T.SHOW_LAST_PROMPT,T.ANSWER_PROMPT,T.TURN_ON_SKIP_RED_TESTS,T.TURN_OFF_SKIP_RED_TESTS,T.REFRESH_TREE_STATE,T.DUMP_EARLY_COVERAGE_PER_METHOD,T.SHOW_ONBOARDING,T.INSTALL_CLI,T.GENERATE_COVERAGE],Q={SUCCESS:0,INVALID_COMMAND:1,UNEXPECTED_ERROR:2,NOT_QA_BUILD_ERROR:3},K={[Q.SUCCESS]:'"{{command}}" finished successfully',[Q.INVALID_COMMAND]:'"{{command}}" is invalid command',[Q.UNEXPECTED_ERROR]:'failed running "{{command}}"',[Q.NOT_QA_BUILD_ERROR]:'"{{command}}" is not available in this build'};var te=_(require("node:process")),ht=require("node:timers/promises");var we=n=>n!=null;var fn=new Error("timeout while waiting for mutex to become available"),mn=new Error("mutex already locked"),fi=new Error("request for lock canceled"),mi=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function c(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):r(u.value).then(c,a)}l((i=i.apply(n,e||[])).next())})},ve=class{constructor(e,t=fi){this._value=e,this._cancelError=t,this._queue=[],this._weightedWaiters=[]}acquire(e=1,t=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((i,r)=>{let s={resolve:i,reject:r,weight:e,priority:t},o=lt(this._queue,c=>t<=c.priority);o===-1&&e<=this._value?this._dispatchItem(s):this._queue.splice(o+1,0,s)})}runExclusive(e){return mi(this,arguments,void 0,function*(t,i=1,r=0){let[s,o]=yield this.acquire(i,r);try{return yield t(s)}finally{o()}})}waitForUnlock(e=1,t=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return this._couldLockImmediately(e,t)?Promise.resolve():new Promise(i=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),pi(this._weightedWaiters[e-1],{resolve:i,priority:t})})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatchQueue()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatchQueue()}cancel(){this._queue.forEach(e=>e.reject(this._cancelError)),this._queue=[]}_dispatchQueue(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()}_dispatchItem(e){let t=this._value;this._value-=e.weight,e.resolve([t,this._newReleaser(e.weight)])}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){if(this._queue.length===0)for(let e=this._value;e>0;e--){let t=this._weightedWaiters[e-1];t&&(t.forEach(i=>i.resolve()),this._weightedWaiters[e-1]=[])}else{let e=this._queue[0].priority;for(let t=this._value;t>0;t--){let i=this._weightedWaiters[t-1];if(!i)continue;let r=i.findIndex(s=>s.priority<=e);(r===-1?i:i.splice(0,r)).forEach(s=>s.resolve())}}}_couldLockImmediately(e,t){return(this._queue.length===0||this._queue[0].priority<t)&&e<=this._value}};function pi(n,e){let t=lt(n,i=>e.priority<=i.priority);n.splice(t+1,0,e)}function lt(n,e){for(let t=n.length-1;t>=0;t--)if(e(n[t]))return t;return-1}var di=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function c(u){try{l(i.next(u))}catch(h){o(h)}}function a(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):r(u.value).then(c,a)}l((i=i.apply(n,e||[])).next())})},J=class{constructor(e){this._semaphore=new ve(1,e)}acquire(){return di(this,arguments,void 0,function*(e=0){let[,t]=yield this._semaphore.acquire(1,e);return t})}runExclusive(e,t=0){return this._semaphore.runExclusive(()=>e(),1,t)}isLocked(){return this._semaphore.isLocked()}waitForUnlock(e=0){return this._semaphore.waitForUnlock(1,e)}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}};var z=class{listeners=[];addListener(e){this.listeners.push(e)}notifyAll(e){for(let t of this.listeners)t(e)}};var F=new J,Z=new z,ee=new AbortController;f.config.id="early-cli";f.config.retry=1500;f.config.silent=!0;var gi=[m.COMMAND_RESPONSE,m.LOGIN_RESPONSE,m.GENERATE_TEST_SUMMARY_RESPONSE,m.PING_RESPONSE,m.PYTHON_EXTRACT_RESPONSE,m.PYTHON_EXTRACT_TESTABLES_RESPONSE,m.PYTHON_EXTRACT_TESTABLES_FROM_MULTIPLE_FILES_RESPONSE],ut=async n=>{await F.acquire(),n&&(f.config.silent=!1),f.connectTo(g,()=>{f.of[g].on("connect",()=>F.release()),f.of[g].on(m.EVENT_RECEIVED,()=>ee.abort());for(let e of gi)f.of[g].on(e,t=>Z.notifyAll(t))})};var _i=({commandName:n,response:{code:e,isSuccess:t,message:i}})=>{we(i)&&console.info(i);let r=K[e].replaceAll("{{command}}",n);t?console.info(r):console.error(r),te.default.exit(t?0:1)},Ei={responseHandler:_i},Ci=1e3,E=async(n,e,t,i)=>{try{await ut(we(n.opts().verbose));let{responseHandler:r}={...Ei,...i};Z.addListener(c=>r({commandName:e,response:c}));let s=async()=>{await(0,ht.setTimeout)(Ci,null,{signal:ee.signal}),console.info("Can't connect to the extension"),te.default.exit(1)},o=async()=>await F.runExclusive(async()=>{t(),console.info(`"${e}" executed in vscode extension`)});await Promise.race([s(),o()])}catch{console.error(`Failed running command "${e}"`),te.default.exit(1)}};var ft="generate-test-summary",mt=n=>n.command(ft).description("generate test summary in json format using specific LLM model").alias("gts").addArgument(new q("model","model name to test on")).addOption(new je("--database-url [databaseUrl]","postgres remote database to push data")).action(async(e,{databaseUrl:t})=>{await E(n,ft,()=>{f.of[g].emit(m.GENERATE_TEST_SUMMARY_REQUEST,{model:e,databaseURL:t?.toString()})})});var pt="ping",Oi=()=>{f.of[g].emit(m.PING_REQUEST)},dt=n=>n.command(pt).description("ping vscode extension").action(async()=>{await E(n,pt,Oi)});var gt="python-extract",_t=n=>n.command(gt).description("python code extraction").argument("file-path","File path").argument("function-name","Function name").argument("[class-name]","Class name (optional)").action(async(e,t,i)=>{await E(n,gt,()=>{f.of[g].emit(m.PYTHON_EXTRACT_REQUEST,{filePath:e,functionName:t,className:i})})});var Et="python-extract-testables",Ct=n=>n.command(Et).description("python testables extraction").argument("file-path","File path").action(async e=>{await E(n,Et,()=>{f.of[g].emit(m.PYTHON_EXTRACT_TESTABLES_REQUEST,{filePath:e})})});var Ot="python-extract-testables-from-multiple-files",At=n=>n.command(Ot).description("python testables extraction from multiple files").argument("file-paths...","File paths").action(async e=>{await E(n,Ot,()=>{f.of[g].emit(m.PYTHON_EXTRACT_TESTABLES_FROM_MULTIPLE_FILES_REQUEST,{filePaths:e})})});var St="0.0.4";var Tt="early-ai",yt="A CLI application for Early AI";var bt="command",wt=n=>n.command(bt).description("execute vscode command").alias("c").addArgument(new q("command","vscode command to execute").choices(ct.map(e=>e.replace(be+".","")))).action(async e=>{await E(n,bt,()=>{f.of[g].emit(m.COMMAND_REQUEST,be+"."+e)},{responseHandler:({response:{code:r,isSuccess:s}})=>{let o=K[r].replaceAll("{{command}}",e);s?console.info(o):console.error(o),process.exit(s?0:1)}})});var Si="login",vt=n=>n.command("login").description("login to vscode extension using JWT").argument("jwt","JWT token").action(async e=>{await E(n,Si,()=>{f.of[g].emit(m.LOGIN_REQUEST,e)})});var xe=async()=>{let n=new Be;n.name(Tt).description(yt).version(St,"-v, --version").option("--verbose","enable verbose output"),wt(n),vt(n),mt(n),dt(n),_t(n),Ct(n),At(n),n.parse(xt.argv)};var Ti=async()=>{await xe()};Ti().catch(()=>{console.error("Failed to run CLI"),Nt.exit(1)});
